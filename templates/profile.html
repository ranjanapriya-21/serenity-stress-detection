{% extends "base.html" %}

{% block content %}
<div style="max-width: 800px; margin: 40px auto;">
    
    <!-- Profile Header -->
    <div style="background: white; border-radius: 40px; padding: 40px; text-align: center; box-shadow: 0 20px 40px rgba(183, 110, 121, 0.15); margin-bottom: 30px;">
        <div style="font-size: 5rem; margin-bottom: 20px;">ðŸŒ¸</div>
        <h1 style="color: #b76e79; font-size: 2.5rem; margin-bottom: 10px;">{{ username }}</h1>
        <p style="color: #8f7a7a; font-size: 1.1rem;">Member since {{ created_at.strftime('%B %d, %Y') }}</p>
    </div>
    
    <!-- Average Stress Level -->
    <div style="background: white; border-radius: 30px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(183, 110, 121, 0.1);">
        <h3 style="color: #b76e79; margin-bottom: 20px; text-align: center;">ðŸ“Š Your Average Stress Level</h3>
        
        {% if avg_stress %}
        <div style="text-align: center; margin-bottom: 20px;">
            <div style="font-size: 3rem; margin-bottom: 10px;">{{ stress_icon }}</div>
            <div style="font-size: 2rem; color: #b76e79; font-weight: 600; margin-bottom: 5px;">{{ avg_stress }}/10</div>
            <div style="color: #8f7a7a;">Average Stress Score</div>
        </div>
        
        <!-- Progress Bar -->
        <div style="background: #f0f0f0; height: 25px; border-radius: 15px; overflow: hidden; margin: 20px 0;">
            <div style="width: {{ (avg_stress / 10 * 100) }}%; height: 100%; background: linear-gradient(90deg, #a7b89e, #b76e79); border-radius: 15px;"></div>
        </div>
        
        <div style="text-align: center; color: #6b5b5b; font-style: italic;">
            {% if avg_stress >= 7 %}
                You've been under high stress lately. Remember to rest, dear. ðŸŒ¸
            {% elif avg_stress >= 4 %}
                You're managing medium stress. Small breaks help! ðŸ’«
            {% else %}
                You're doing well with low stress. Keep going! ðŸŒ¿
            {% endif %}
        </div>
        {% else %}
        <p style="text-align: center; color: #8f7a7a;">Start chatting to see your stress analysis!</p>
        {% endif %}
    </div>
    
    <!-- Stats Cards -->
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
        <div style="background: white; border-radius: 30px; padding: 30px; text-align: center; box-shadow: 0 10px 30px rgba(183, 110, 121, 0.1);">
            <div style="font-size: 2.5rem; color: #b76e79; margin-bottom: 10px;">{{ total_conversations }}</div>
            <div style="color: #8f7a7a;">Conversations</div>
        </div>
        
        <div style="background: white; border-radius: 30px; padding: 30px; text-align: center; box-shadow: 0 10px 30px rgba(183, 110, 121, 0.1);">
            <div style="font-size: 2.5rem; color: #b76e79; margin-bottom: 10px;">{{ unique_emotions }}</div>
            <div style="color: #8f7a7a;">Emotions Explored</div>
        </div>
        
        <div style="background: white; border-radius: 30px; padding: 30px; text-align: center; box-shadow: 0 10px 30px rgba(183, 110, 121, 0.1);">
            <div style="font-size: 2.5rem; color: #b76e79; margin-bottom: 10px;">{{ last_active }}</div>
            <div style="color: #8f7a7a;">Last Active</div>
        </div>
    </div>
    
    <!-- Emotion Distribution -->
    {% if emotion_stats %}
    <div style="background: white; border-radius: 40px; padding: 30px; box-shadow: 0 20px 40px rgba(183, 110, 121, 0.1);">
        <h2 style="color: #b76e79; margin-bottom: 25px; text-align: center;">Your Emotional Journey ðŸŒˆ</h2>
        
        {% for emotion, count in emotion_stats.items() %}
        <div style="margin-bottom: 15px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                <span style="color: #6b5b5b;">{{ emotion }}</span>
                <span style="color: #b76e79; font-weight: 600;">{{ count }} time{% if count > 1 %}s{% endif %}</span>
            </div>
            <div style="background: #f9eef2; height: 10px; border-radius: 10px; overflow: hidden;">
                {% set percentage = (count / total_conversations * 100) if total_conversations > 0 else 0 %}
                <div style="background: linear-gradient(90deg, #b76e79, #d48c98); width: {{ percentage }}%; height: 100%; border-radius: 10px;"></div>
            </div>
        </div>
        {% endfor %}
        
        <!-- Encouraging Message -->
        <div style="background: #f9eef2; border-radius: 20px; padding: 20px; margin-top: 25px; text-align: center;">
            <p style="color: #6b5b5b; font-style: italic;">
                "Every emotion you feel is valid. You're doing beautifully on your healing journey."
            </p>
        </div>
    </div>
    {% endif %}
    
    <!-- Action Buttons -->
    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
        <a href="/chat" style="padding: 15px 40px; background: linear-gradient(135deg, #b76e79 0%, #d48c98 100%); color: white; text-decoration: none; border-radius: 40px; font-weight: 600; transition: all 0.3s;">
            Continue Talking ðŸ’¬
        </a>
        <a href="/history" style="padding: 15px 40px; background: transparent; color: #b76e79; text-decoration: none; border-radius: 40px; font-weight: 600; border: 2px solid #b76e79; transition: all 0.3s;">
            View History ðŸ“–
        </a>
    </div>
</div>

<style>
    a:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(183, 110, 121, 0.2);
    }
    .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(183, 110, 121, 0.15);
    }
</style>
{% endblock %}